D:\Dcodes\AcademicResearch2\.venv\Scripts\python.exe D:\Dcodes\AcademicResearch2\DiagSelect2.py
Data Loaded: Train torch.Size([16852, 8]), Val torch.Size([2408, 8]), Test torch.Size([4815, 8])
Features: 8, Classes: 3

>>> Phase 1: 训练 Agent (寻找最佳筛选策略)...
Step [1/500] | Avg Reward: 0.8086 | Selected Avg: 8721.3
Step [2/500] | Avg Reward: 0.8279 | Selected Avg: 10806.7
Step [3/500] | Avg Reward: 0.8562 | Selected Avg: 15159.0
Step [4/500] | Avg Reward: 0.8607 | Selected Avg: 15581.0
Step [5/500] | Avg Reward: 0.8519 | Selected Avg: 15255.3
Step [6/500] | Avg Reward: 0.8526 | Selected Avg: 15564.0
Step [7/500] | Avg Reward: 0.8469 | Selected Avg: 14752.3
Step [8/500] | Avg Reward: 0.8468 | Selected Avg: 14961.7
Step [9/500] | Avg Reward: 0.8498 | Selected Avg: 15019.3
Step [10/500] | Avg Reward: 0.8510 | Selected Avg: 15424.7
Step [11/500] | Avg Reward: 0.8517 | Selected Avg: 15123.3
Step [12/500] | Avg Reward: 0.8468 | Selected Avg: 14939.0
Step [13/500] | Avg Reward: 0.8495 | Selected Avg: 15004.7
Step [14/500] | Avg Reward: 0.8510 | Selected Avg: 15769.0
Step [15/500] | Avg Reward: 0.8521 | Selected Avg: 15685.0
Step [16/500] | Avg Reward: 0.8601 | Selected Avg: 16283.0
Step [17/500] | Avg Reward: 0.8542 | Selected Avg: 16422.0
Step [18/500] | Avg Reward: 0.8603 | Selected Avg: 16434.7
Step [19/500] | Avg Reward: 0.8546 | Selected Avg: 16583.7
Step [20/500] | Avg Reward: 0.8563 | Selected Avg: 16623.0
Step [21/500] | Avg Reward: 0.8565 | Selected Avg: 16652.7
Step [22/500] | Avg Reward: 0.8546 | Selected Avg: 16636.3
Step [23/500] | Avg Reward: 0.8575 | Selected Avg: 16773.0
Step [24/500] | Avg Reward: 0.8574 | Selected Avg: 16777.7
Step [25/500] | Avg Reward: 0.8575 | Selected Avg: 16775.0
Step [26/500] | Avg Reward: 0.8559 | Selected Avg: 16774.0
Step [27/500] | Avg Reward: 0.8544 | Selected Avg: 16796.0
Step [28/500] | Avg Reward: 0.8579 | Selected Avg: 16825.3
Step [29/500] | Avg Reward: 0.8576 | Selected Avg: 16818.0
Step [30/500] | Avg Reward: 0.8579 | Selected Avg: 16813.7
Step [31/500] | Avg Reward: 0.8573 | Selected Avg: 16823.7
Step [32/500] | Avg Reward: 0.8573 | Selected Avg: 16818.3
Step [33/500] | Avg Reward: 0.8559 | Selected Avg: 16816.0
Step [34/500] | Avg Reward: 0.8576 | Selected Avg: 16814.3
Step [35/500] | Avg Reward: 0.8572 | Selected Avg: 16820.7
Step [36/500] | Avg Reward: 0.8577 | Selected Avg: 16816.3
Step [37/500] | Avg Reward: 0.8572 | Selected Avg: 16811.7
Step [38/500] | Avg Reward: 0.8573 | Selected Avg: 16811.0
Step [39/500] | Avg Reward: 0.8576 | Selected Avg: 16816.7
Step [40/500] | Avg Reward: 0.8577 | Selected Avg: 16810.3
Step [41/500] | Avg Reward: 0.8575 | Selected Avg: 16816.7
Step [42/500] | Avg Reward: 0.8571 | Selected Avg: 16814.3
Step [43/500] | Avg Reward: 0.8574 | Selected Avg: 16811.7
Step [44/500] | Avg Reward: 0.8575 | Selected Avg: 16812.7
Step [45/500] | Avg Reward: 0.8559 | Selected Avg: 16815.3
Step [46/500] | Avg Reward: 0.8566 | Selected Avg: 16812.0
Step [47/500] | Avg Reward: 0.8589 | Selected Avg: 16816.3
Step [48/500] | Avg Reward: 0.8572 | Selected Avg: 16807.3
Step [49/500] | Avg Reward: 0.8577 | Selected Avg: 16814.7
Step [50/500] | Avg Reward: 0.8574 | Selected Avg: 16816.7
Step [51/500] | Avg Reward: 0.8574 | Selected Avg: 16811.7
Step [52/500] | Avg Reward: 0.8572 | Selected Avg: 16812.0
Step [53/500] | Avg Reward: 0.8576 | Selected Avg: 16809.3
Step [54/500] | Avg Reward: 0.8575 | Selected Avg: 16814.7
Step [55/500] | Avg Reward: 0.8570 | Selected Avg: 16817.7
Step [56/500] | Avg Reward: 0.8573 | Selected Avg: 16811.3
Step [57/500] | Avg Reward: 0.8573 | Selected Avg: 16813.3
Step [58/500] | Avg Reward: 0.8575 | Selected Avg: 16815.0
Step [59/500] | Avg Reward: 0.8575 | Selected Avg: 16813.0
Step [60/500] | Avg Reward: 0.8577 | Selected Avg: 16810.0
Step [61/500] | Avg Reward: 0.8561 | Selected Avg: 16810.7
Step [62/500] | Avg Reward: 0.8572 | Selected Avg: 16814.7
Step [63/500] | Avg Reward: 0.8573 | Selected Avg: 16808.0
Step [64/500] | Avg Reward: 0.8572 | Selected Avg: 16807.3
Step [65/500] | Avg Reward: 0.8542 | Selected Avg: 16810.7
Step [66/500] | Avg Reward: 0.8575 | Selected Avg: 16810.3
Step [67/500] | Avg Reward: 0.8553 | Selected Avg: 16811.3
Step [68/500] | Avg Reward: 0.8575 | Selected Avg: 16821.7
Step [69/500] | Avg Reward: 0.8574 | Selected Avg: 16807.7
Step [70/500] | Avg Reward: 0.8572 | Selected Avg: 16810.0
Step [71/500] | Avg Reward: 0.8578 | Selected Avg: 16813.0
Step [72/500] | Avg Reward: 0.8571 | Selected Avg: 16806.7
Step [73/500] | Avg Reward: 0.8572 | Selected Avg: 16806.7
Step [74/500] | Avg Reward: 0.8574 | Selected Avg: 16807.7
Step [75/500] | Avg Reward: 0.8573 | Selected Avg: 16806.3
Step [76/500] | Avg Reward: 0.8572 | Selected Avg: 16802.7
Step [77/500] | Avg Reward: 0.8576 | Selected Avg: 16802.3
Step [78/500] | Avg Reward: 0.8573 | Selected Avg: 16808.0
Step [79/500] | Avg Reward: 0.8542 | Selected Avg: 16813.7
Step [80/500] | Avg Reward: 0.8574 | Selected Avg: 16821.0
Step [81/500] | Avg Reward: 0.8573 | Selected Avg: 16824.3
Step [82/500] | Avg Reward: 0.8574 | Selected Avg: 16826.3
Step [83/500] | Avg Reward: 0.8572 | Selected Avg: 16828.3
Step [84/500] | Avg Reward: 0.8573 | Selected Avg: 16818.0
Step [85/500] | Avg Reward: 0.8575 | Selected Avg: 16819.3
Step [86/500] | Avg Reward: 0.8574 | Selected Avg: 16825.3
Step [87/500] | Avg Reward: 0.8574 | Selected Avg: 16824.3
Step [88/500] | Avg Reward: 0.8571 | Selected Avg: 16824.0
Step [89/500] | Avg Reward: 0.8574 | Selected Avg: 16817.3
Step [90/500] | Avg Reward: 0.8574 | Selected Avg: 16822.3
Step [91/500] | Avg Reward: 0.8575 | Selected Avg: 16825.0
Step [92/500] | Avg Reward: 0.8571 | Selected Avg: 16817.7
Step [93/500] | Avg Reward: 0.8577 | Selected Avg: 16822.7
Step [94/500] | Avg Reward: 0.8574 | Selected Avg: 16817.3
Step [95/500] | Avg Reward: 0.8574 | Selected Avg: 16822.0
Step [96/500] | Avg Reward: 0.8576 | Selected Avg: 16820.3
Step [97/500] | Avg Reward: 0.8573 | Selected Avg: 16824.0
Step [98/500] | Avg Reward: 0.8561 | Selected Avg: 16820.0
Step [99/500] | Avg Reward: 0.8573 | Selected Avg: 16824.0
Step [100/500] | Avg Reward: 0.8572 | Selected Avg: 16820.0
Step [101/500] | Avg Reward: 0.8574 | Selected Avg: 16819.0
Step [102/500] | Avg Reward: 0.8575 | Selected Avg: 16821.3
Step [103/500] | Avg Reward: 0.8575 | Selected Avg: 16821.0
Step [104/500] | Avg Reward: 0.8574 | Selected Avg: 16825.3
Step [105/500] | Avg Reward: 0.8575 | Selected Avg: 16826.7
Step [106/500] | Avg Reward: 0.8575 | Selected Avg: 16816.3
Step [107/500] | Avg Reward: 0.8574 | Selected Avg: 16818.7
Step [108/500] | Avg Reward: 0.8574 | Selected Avg: 16826.0
Step [109/500] | Avg Reward: 0.8575 | Selected Avg: 16825.0
Step [110/500] | Avg Reward: 0.8574 | Selected Avg: 16824.0
Step [111/500] | Avg Reward: 0.8574 | Selected Avg: 16828.0
Step [112/500] | Avg Reward: 0.8574 | Selected Avg: 16821.0
Step [113/500] | Avg Reward: 0.8572 | Selected Avg: 16824.7
Step [114/500] | Avg Reward: 0.8574 | Selected Avg: 16821.0
Step [115/500] | Avg Reward: 0.8574 | Selected Avg: 16824.7
Step [116/500] | Avg Reward: 0.8577 | Selected Avg: 16823.7
Step [117/500] | Avg Reward: 0.8576 | Selected Avg: 16821.7
Step [118/500] | Avg Reward: 0.8576 | Selected Avg: 16820.7
Step [119/500] | Avg Reward: 0.8574 | Selected Avg: 16820.3
Step [120/500] | Avg Reward: 0.8547 | Selected Avg: 16818.3
Step [121/500] | Avg Reward: 0.8574 | Selected Avg: 16813.3
Step [122/500] | Avg Reward: 0.8572 | Selected Avg: 16804.0
Step [123/500] | Avg Reward: 0.8574 | Selected Avg: 16814.7
Step [124/500] | Avg Reward: 0.8578 | Selected Avg: 16814.0
Step [125/500] | Avg Reward: 0.8570 | Selected Avg: 16814.3
Step [126/500] | Avg Reward: 0.8576 | Selected Avg: 16808.7
Step [127/500] | Avg Reward: 0.8571 | Selected Avg: 16812.7
Step [128/500] | Avg Reward: 0.8578 | Selected Avg: 16808.3
Step [129/500] | Avg Reward: 0.8573 | Selected Avg: 16816.3
Step [130/500] | Avg Reward: 0.8573 | Selected Avg: 16811.7
Step [131/500] | Avg Reward: 0.8555 | Selected Avg: 16814.0
Step [132/500] | Avg Reward: 0.8574 | Selected Avg: 16831.3
Step [133/500] | Avg Reward: 0.8574 | Selected Avg: 16824.0
Step [134/500] | Avg Reward: 0.8571 | Selected Avg: 16824.0
Step [135/500] | Avg Reward: 0.8574 | Selected Avg: 16828.7
Step [136/500] | Avg Reward: 0.8573 | Selected Avg: 16828.3
Step [137/500] | Avg Reward: 0.8574 | Selected Avg: 16829.3
Step [138/500] | Avg Reward: 0.8577 | Selected Avg: 16826.0
Step [139/500] | Avg Reward: 0.8564 | Selected Avg: 16826.0
Step [140/500] | Avg Reward: 0.8574 | Selected Avg: 16815.3
Step [141/500] | Avg Reward: 0.8574 | Selected Avg: 16817.7
Step [142/500] | Avg Reward: 0.8571 | Selected Avg: 16823.0
Step [143/500] | Avg Reward: 0.8573 | Selected Avg: 16823.3
Step [144/500] | Avg Reward: 0.8570 | Selected Avg: 16820.7
Step [145/500] | Avg Reward: 0.8572 | Selected Avg: 16825.0
Step [146/500] | Avg Reward: 0.8574 | Selected Avg: 16819.7
Step [147/500] | Avg Reward: 0.8578 | Selected Avg: 16826.0
Step [148/500] | Avg Reward: 0.8572 | Selected Avg: 16827.0
Step [149/500] | Avg Reward: 0.8576 | Selected Avg: 16824.7
Step [150/500] | Avg Reward: 0.8574 | Selected Avg: 16828.0
Step [151/500] | Avg Reward: 0.8574 | Selected Avg: 16824.0
Step [152/500] | Avg Reward: 0.8575 | Selected Avg: 16824.3
Step [153/500] | Avg Reward: 0.8572 | Selected Avg: 16827.7
Step [154/500] | Avg Reward: 0.8571 | Selected Avg: 16830.7
Step [155/500] | Avg Reward: 0.8571 | Selected Avg: 16828.0
Step [156/500] | Avg Reward: 0.8578 | Selected Avg: 16826.3
Step [157/500] | Avg Reward: 0.8571 | Selected Avg: 16830.0
Step [158/500] | Avg Reward: 0.8570 | Selected Avg: 16823.0
Step [159/500] | Avg Reward: 0.8576 | Selected Avg: 16824.3
Step [160/500] | Avg Reward: 0.8588 | Selected Avg: 16821.0
Step [161/500] | Avg Reward: 0.8573 | Selected Avg: 16823.0
Step [162/500] | Avg Reward: 0.8572 | Selected Avg: 16826.3
Step [163/500] | Avg Reward: 0.8530 | Selected Avg: 16824.0
Step [164/500] | Avg Reward: 0.8574 | Selected Avg: 16830.7
Step [165/500] | Avg Reward: 0.8574 | Selected Avg: 16829.0
Step [166/500] | Avg Reward: 0.8573 | Selected Avg: 16831.7
Step [167/500] | Avg Reward: 0.8575 | Selected Avg: 16825.7
Step [168/500] | Avg Reward: 0.8573 | Selected Avg: 16830.0
Step [169/500] | Avg Reward: 0.8575 | Selected Avg: 16826.3
Step [170/500] | Avg Reward: 0.8576 | Selected Avg: 16828.7
Step [171/500] | Avg Reward: 0.8575 | Selected Avg: 16827.0
Step [172/500] | Avg Reward: 0.8575 | Selected Avg: 16826.0
Step [173/500] | Avg Reward: 0.8573 | Selected Avg: 16829.3
Step [174/500] | Avg Reward: 0.8576 | Selected Avg: 16828.7
Step [175/500] | Avg Reward: 0.8574 | Selected Avg: 16826.7
Step [176/500] | Avg Reward: 0.8572 | Selected Avg: 16824.7
Step [177/500] | Avg Reward: 0.8563 | Selected Avg: 16828.7
Step [178/500] | Avg Reward: 0.8575 | Selected Avg: 16834.0
Step [179/500] | Avg Reward: 0.8559 | Selected Avg: 16833.0
Step [180/500] | Avg Reward: 0.8574 | Selected Avg: 16836.3
Step [181/500] | Avg Reward: 0.8573 | Selected Avg: 16838.7
Step [182/500] | Avg Reward: 0.8573 | Selected Avg: 16836.7
Step [183/500] | Avg Reward: 0.8574 | Selected Avg: 16835.7
Step [184/500] | Avg Reward: 0.8586 | Selected Avg: 16832.3
Step [185/500] | Avg Reward: 0.8574 | Selected Avg: 16835.3
Step [186/500] | Avg Reward: 0.8575 | Selected Avg: 16833.7
Step [187/500] | Avg Reward: 0.8574 | Selected Avg: 16838.3
Step [188/500] | Avg Reward: 0.8575 | Selected Avg: 16837.3
Step [189/500] | Avg Reward: 0.8574 | Selected Avg: 16835.0
Step [190/500] | Avg Reward: 0.8574 | Selected Avg: 16839.3
Step [191/500] | Avg Reward: 0.8575 | Selected Avg: 16831.7
Step [192/500] | Avg Reward: 0.8571 | Selected Avg: 16834.0
Step [193/500] | Avg Reward: 0.8575 | Selected Avg: 16831.7
Step [194/500] | Avg Reward: 0.8575 | Selected Avg: 16834.3
Step [195/500] | Avg Reward: 0.8574 | Selected Avg: 16833.0
Step [196/500] | Avg Reward: 0.8573 | Selected Avg: 16834.7
Step [197/500] | Avg Reward: 0.8574 | Selected Avg: 16831.3
Step [198/500] | Avg Reward: 0.8573 | Selected Avg: 16828.3
Step [199/500] | Avg Reward: 0.8575 | Selected Avg: 16833.0
Step [200/500] | Avg Reward: 0.8574 | Selected Avg: 16837.0
Step [201/500] | Avg Reward: 0.8574 | Selected Avg: 16833.7
Step [202/500] | Avg Reward: 0.8573 | Selected Avg: 16834.0
Step [203/500] | Avg Reward: 0.8573 | Selected Avg: 16833.3
Step [204/500] | Avg Reward: 0.8573 | Selected Avg: 16831.0
Step [205/500] | Avg Reward: 0.8574 | Selected Avg: 16836.0
Step [206/500] | Avg Reward: 0.8574 | Selected Avg: 16830.7
Step [207/500] | Avg Reward: 0.8575 | Selected Avg: 16835.3
Step [208/500] | Avg Reward: 0.8572 | Selected Avg: 16834.7
Step [209/500] | Avg Reward: 0.8574 | Selected Avg: 16838.3
Step [210/500] | Avg Reward: 0.8571 | Selected Avg: 16834.3
Step [211/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [212/500] | Avg Reward: 0.8574 | Selected Avg: 16835.0
Step [213/500] | Avg Reward: 0.8574 | Selected Avg: 16835.3
Step [214/500] | Avg Reward: 0.8558 | Selected Avg: 16836.0
Step [215/500] | Avg Reward: 0.8573 | Selected Avg: 16832.7
Step [216/500] | Avg Reward: 0.8574 | Selected Avg: 16833.0
Step [217/500] | Avg Reward: 0.8574 | Selected Avg: 16829.7
Step [218/500] | Avg Reward: 0.8573 | Selected Avg: 16835.3
Step [219/500] | Avg Reward: 0.8574 | Selected Avg: 16835.3
Step [220/500] | Avg Reward: 0.8574 | Selected Avg: 16834.7
Step [221/500] | Avg Reward: 0.8574 | Selected Avg: 16834.0
Step [222/500] | Avg Reward: 0.8572 | Selected Avg: 16836.3
Step [223/500] | Avg Reward: 0.8573 | Selected Avg: 16833.0
Step [224/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [225/500] | Avg Reward: 0.8573 | Selected Avg: 16834.7
Step [226/500] | Avg Reward: 0.8589 | Selected Avg: 16837.7
Step [227/500] | Avg Reward: 0.8574 | Selected Avg: 16832.7
Step [228/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [229/500] | Avg Reward: 0.8575 | Selected Avg: 16831.7
Step [230/500] | Avg Reward: 0.8575 | Selected Avg: 16836.7
Step [231/500] | Avg Reward: 0.8578 | Selected Avg: 16833.0
Step [232/500] | Avg Reward: 0.8559 | Selected Avg: 16831.7
Step [233/500] | Avg Reward: 0.8576 | Selected Avg: 16833.7
Step [234/500] | Avg Reward: 0.8575 | Selected Avg: 16836.0
Step [235/500] | Avg Reward: 0.8575 | Selected Avg: 16835.0
Step [236/500] | Avg Reward: 0.8574 | Selected Avg: 16835.7
Step [237/500] | Avg Reward: 0.8574 | Selected Avg: 16837.3
Step [238/500] | Avg Reward: 0.8570 | Selected Avg: 16827.3
Step [239/500] | Avg Reward: 0.8574 | Selected Avg: 16823.0
Step [240/500] | Avg Reward: 0.8575 | Selected Avg: 16817.7
Step [241/500] | Avg Reward: 0.8570 | Selected Avg: 16820.3
Step [242/500] | Avg Reward: 0.8577 | Selected Avg: 16822.3
Step [243/500] | Avg Reward: 0.8571 | Selected Avg: 16823.3
Step [244/500] | Avg Reward: 0.8574 | Selected Avg: 16828.3
Step [245/500] | Avg Reward: 0.8570 | Selected Avg: 16827.3
Step [246/500] | Avg Reward: 0.8540 | Selected Avg: 16822.7
Step [247/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [248/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [249/500] | Avg Reward: 0.8573 | Selected Avg: 16836.7
Step [250/500] | Avg Reward: 0.8573 | Selected Avg: 16836.7
Step [251/500] | Avg Reward: 0.8574 | Selected Avg: 16832.0
Step [252/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [253/500] | Avg Reward: 0.8574 | Selected Avg: 16841.0
Step [254/500] | Avg Reward: 0.8574 | Selected Avg: 16837.7
Step [255/500] | Avg Reward: 0.8574 | Selected Avg: 16835.3
Step [256/500] | Avg Reward: 0.8578 | Selected Avg: 16836.7
Step [257/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [258/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [259/500] | Avg Reward: 0.8574 | Selected Avg: 16833.3
Step [260/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [261/500] | Avg Reward: 0.8574 | Selected Avg: 16835.0
Step [262/500] | Avg Reward: 0.8571 | Selected Avg: 16833.0
Step [263/500] | Avg Reward: 0.8574 | Selected Avg: 16837.3
Step [264/500] | Avg Reward: 0.8576 | Selected Avg: 16834.7
Step [265/500] | Avg Reward: 0.8574 | Selected Avg: 16836.3
Step [266/500] | Avg Reward: 0.8574 | Selected Avg: 16835.0
Step [267/500] | Avg Reward: 0.8575 | Selected Avg: 16837.0
Step [268/500] | Avg Reward: 0.8574 | Selected Avg: 16833.0
Step [269/500] | Avg Reward: 0.8576 | Selected Avg: 16833.3
Step [270/500] | Avg Reward: 0.8574 | Selected Avg: 16841.0
Step [271/500] | Avg Reward: 0.8575 | Selected Avg: 16838.7
Step [272/500] | Avg Reward: 0.8574 | Selected Avg: 16834.7
Step [273/500] | Avg Reward: 0.8575 | Selected Avg: 16836.7
Step [274/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [275/500] | Avg Reward: 0.8574 | Selected Avg: 16839.3
Step [276/500] | Avg Reward: 0.8575 | Selected Avg: 16836.0
Step [277/500] | Avg Reward: 0.8574 | Selected Avg: 16839.3
Step [278/500] | Avg Reward: 0.8574 | Selected Avg: 16840.0
Step [279/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [280/500] | Avg Reward: 0.8574 | Selected Avg: 16838.0
Step [281/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [282/500] | Avg Reward: 0.8575 | Selected Avg: 16834.3
Step [283/500] | Avg Reward: 0.8573 | Selected Avg: 16835.0
Step [284/500] | Avg Reward: 0.8575 | Selected Avg: 16836.3
Step [285/500] | Avg Reward: 0.8572 | Selected Avg: 16836.7
Step [286/500] | Avg Reward: 0.8575 | Selected Avg: 16836.7
Step [287/500] | Avg Reward: 0.8574 | Selected Avg: 16834.7
Step [288/500] | Avg Reward: 0.8575 | Selected Avg: 16837.0
Step [289/500] | Avg Reward: 0.8574 | Selected Avg: 16834.7
Step [290/500] | Avg Reward: 0.8574 | Selected Avg: 16839.7
Step [291/500] | Avg Reward: 0.8572 | Selected Avg: 16838.7
Step [292/500] | Avg Reward: 0.8574 | Selected Avg: 16835.7
Step [293/500] | Avg Reward: 0.8577 | Selected Avg: 16832.3
Step [294/500] | Avg Reward: 0.8578 | Selected Avg: 16830.7
Step [295/500] | Avg Reward: 0.8575 | Selected Avg: 16834.0
Step [296/500] | Avg Reward: 0.8576 | Selected Avg: 16833.3
Step [297/500] | Avg Reward: 0.8575 | Selected Avg: 16834.0
Step [298/500] | Avg Reward: 0.8573 | Selected Avg: 16835.3
Step [299/500] | Avg Reward: 0.8574 | Selected Avg: 16834.3
Step [300/500] | Avg Reward: 0.8573 | Selected Avg: 16835.0
Step [301/500] | Avg Reward: 0.8574 | Selected Avg: 16838.3
Step [302/500] | Avg Reward: 0.8573 | Selected Avg: 16833.7
Step [303/500] | Avg Reward: 0.8572 | Selected Avg: 16833.7
Step [304/500] | Avg Reward: 0.8575 | Selected Avg: 16837.7
Step [305/500] | Avg Reward: 0.8574 | Selected Avg: 16836.3
Step [306/500] | Avg Reward: 0.8574 | Selected Avg: 16833.0
Step [307/500] | Avg Reward: 0.8574 | Selected Avg: 16837.0
Step [308/500] | Avg Reward: 0.8573 | Selected Avg: 16835.3
Step [309/500] | Avg Reward: 0.8575 | Selected Avg: 16837.3
Step [310/500] | Avg Reward: 0.8574 | Selected Avg: 16839.0
Step [311/500] | Avg Reward: 0.8574 | Selected Avg: 16838.7
Step [312/500] | Avg Reward: 0.8574 | Selected Avg: 16836.7
Step [313/500] | Avg Reward: 0.8574 | Selected Avg: 16835.7
Step [314/500] | Avg Reward: 0.8574 | Selected Avg: 16834.0
Step [315/500] | Avg Reward: 0.8572 | Selected Avg: 16837.3
Step [316/500] | Avg Reward: 0.8569 | Selected Avg: 16842.3
Step [317/500] | Avg Reward: 0.8571 | Selected Avg: 16838.3
Step [318/500] | Avg Reward: 0.8574 | Selected Avg: 16837.3
Step [319/500] | Avg Reward: 0.8574 | Selected Avg: 16835.0
Step [320/500] | Avg Reward: 0.8544 | Selected Avg: 16834.7
Step [321/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [322/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [323/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [324/500] | Avg Reward: 0.8574 | Selected Avg: 16848.3
Step [325/500] | Avg Reward: 0.8574 | Selected Avg: 16847.3
Step [326/500] | Avg Reward: 0.8575 | Selected Avg: 16845.0
Step [327/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [328/500] | Avg Reward: 0.8574 | Selected Avg: 16844.3
Step [329/500] | Avg Reward: 0.8575 | Selected Avg: 16845.7
Step [330/500] | Avg Reward: 0.8574 | Selected Avg: 16848.7
Step [331/500] | Avg Reward: 0.8574 | Selected Avg: 16847.0
Step [332/500] | Avg Reward: 0.8574 | Selected Avg: 16844.3
Step [333/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [334/500] | Avg Reward: 0.8574 | Selected Avg: 16846.0
Step [335/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [336/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [337/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [338/500] | Avg Reward: 0.8574 | Selected Avg: 16848.0
Step [339/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [340/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [341/500] | Avg Reward: 0.8574 | Selected Avg: 16844.7
Step [342/500] | Avg Reward: 0.8575 | Selected Avg: 16848.7
Step [343/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [344/500] | Avg Reward: 0.8575 | Selected Avg: 16849.0
Step [345/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [346/500] | Avg Reward: 0.8574 | Selected Avg: 16847.0
Step [347/500] | Avg Reward: 0.8574 | Selected Avg: 16846.7
Step [348/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [349/500] | Avg Reward: 0.8575 | Selected Avg: 16848.7
Step [350/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [351/500] | Avg Reward: 0.8575 | Selected Avg: 16849.0
Step [352/500] | Avg Reward: 0.8574 | Selected Avg: 16848.0
Step [353/500] | Avg Reward: 0.8575 | Selected Avg: 16845.3
Step [354/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [355/500] | Avg Reward: 0.8574 | Selected Avg: 16846.0
Step [356/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [357/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [358/500] | Avg Reward: 0.8573 | Selected Avg: 16847.0
Step [359/500] | Avg Reward: 0.8574 | Selected Avg: 16846.0
Step [360/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [361/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [362/500] | Avg Reward: 0.8574 | Selected Avg: 16848.7
Step [363/500] | Avg Reward: 0.8575 | Selected Avg: 16847.0
Step [364/500] | Avg Reward: 0.8575 | Selected Avg: 16847.0
Step [365/500] | Avg Reward: 0.8574 | Selected Avg: 16845.3
Step [366/500] | Avg Reward: 0.8573 | Selected Avg: 16847.0
Step [367/500] | Avg Reward: 0.8574 | Selected Avg: 16849.0
Step [368/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [369/500] | Avg Reward: 0.8574 | Selected Avg: 16846.3
Step [370/500] | Avg Reward: 0.8571 | Selected Avg: 16845.3
Step [371/500] | Avg Reward: 0.8574 | Selected Avg: 16846.0
Step [372/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [373/500] | Avg Reward: 0.8574 | Selected Avg: 16847.0
Step [374/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [375/500] | Avg Reward: 0.8575 | Selected Avg: 16845.0
Step [376/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [377/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [378/500] | Avg Reward: 0.8574 | Selected Avg: 16845.7
Step [379/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [380/500] | Avg Reward: 0.8574 | Selected Avg: 16848.7
Step [381/500] | Avg Reward: 0.8574 | Selected Avg: 16848.7
Step [382/500] | Avg Reward: 0.8576 | Selected Avg: 16848.0
Step [383/500] | Avg Reward: 0.8574 | Selected Avg: 16846.3
Step [384/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [385/500] | Avg Reward: 0.8574 | Selected Avg: 16848.3
Step [386/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [387/500] | Avg Reward: 0.8575 | Selected Avg: 16847.0
Step [388/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [389/500] | Avg Reward: 0.8575 | Selected Avg: 16847.0
Step [390/500] | Avg Reward: 0.8575 | Selected Avg: 16849.3
Step [391/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [392/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [393/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [394/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [395/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [396/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [397/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [398/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [399/500] | Avg Reward: 0.8589 | Selected Avg: 16848.0
Step [400/500] | Avg Reward: 0.8561 | Selected Avg: 16846.0
Step [401/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [402/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [403/500] | Avg Reward: 0.8574 | Selected Avg: 16844.7
Step [404/500] | Avg Reward: 0.8575 | Selected Avg: 16848.7
Step [405/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [406/500] | Avg Reward: 0.8574 | Selected Avg: 16848.3
Step [407/500] | Avg Reward: 0.8589 | Selected Avg: 16847.0
Step [408/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [409/500] | Avg Reward: 0.8574 | Selected Avg: 16845.0
Step [410/500] | Avg Reward: 0.8574 | Selected Avg: 16844.7
Step [411/500] | Avg Reward: 0.8574 | Selected Avg: 16847.3
Step [412/500] | Avg Reward: 0.8574 | Selected Avg: 16846.0
Step [413/500] | Avg Reward: 0.8574 | Selected Avg: 16843.3
Step [414/500] | Avg Reward: 0.8577 | Selected Avg: 16843.7
Step [415/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [416/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [417/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [418/500] | Avg Reward: 0.8575 | Selected Avg: 16847.0
Step [419/500] | Avg Reward: 0.8577 | Selected Avg: 16845.7
Step [420/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [421/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [422/500] | Avg Reward: 0.8573 | Selected Avg: 16845.7
Step [423/500] | Avg Reward: 0.8575 | Selected Avg: 16845.7
Step [424/500] | Avg Reward: 0.8574 | Selected Avg: 16841.0
Step [425/500] | Avg Reward: 0.8574 | Selected Avg: 16848.0
Step [426/500] | Avg Reward: 0.8575 | Selected Avg: 16844.3
Step [427/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [428/500] | Avg Reward: 0.8574 | Selected Avg: 16845.7
Step [429/500] | Avg Reward: 0.8574 | Selected Avg: 16844.7
Step [430/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [431/500] | Avg Reward: 0.8574 | Selected Avg: 16845.0
Step [432/500] | Avg Reward: 0.8576 | Selected Avg: 16846.3
Step [433/500] | Avg Reward: 0.8574 | Selected Avg: 16847.0
Step [434/500] | Avg Reward: 0.8572 | Selected Avg: 16847.0
Step [435/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [436/500] | Avg Reward: 0.8574 | Selected Avg: 16846.7
Step [437/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [438/500] | Avg Reward: 0.8573 | Selected Avg: 16847.7
Step [439/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [440/500] | Avg Reward: 0.8576 | Selected Avg: 16848.3
Step [441/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [442/500] | Avg Reward: 0.8574 | Selected Avg: 16845.7
Step [443/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [444/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [445/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [446/500] | Avg Reward: 0.8574 | Selected Avg: 16845.3
Step [447/500] | Avg Reward: 0.8575 | Selected Avg: 16849.7
Step [448/500] | Avg Reward: 0.8575 | Selected Avg: 16849.0
Step [449/500] | Avg Reward: 0.8573 | Selected Avg: 16846.7
Step [450/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [451/500] | Avg Reward: 0.8572 | Selected Avg: 16846.3
Step [452/500] | Avg Reward: 0.8574 | Selected Avg: 16846.7
Step [453/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [454/500] | Avg Reward: 0.8575 | Selected Avg: 16844.3
Step [455/500] | Avg Reward: 0.8574 | Selected Avg: 16847.3
Step [456/500] | Avg Reward: 0.8574 | Selected Avg: 16846.3
Step [457/500] | Avg Reward: 0.8575 | Selected Avg: 16846.0
Step [458/500] | Avg Reward: 0.8575 | Selected Avg: 16849.0
Step [459/500] | Avg Reward: 0.8575 | Selected Avg: 16845.3
Step [460/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [461/500] | Avg Reward: 0.8572 | Selected Avg: 16848.0
Step [462/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [463/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [464/500] | Avg Reward: 0.8573 | Selected Avg: 16846.7
Step [465/500] | Avg Reward: 0.8574 | Selected Avg: 16848.7
Step [466/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [467/500] | Avg Reward: 0.8574 | Selected Avg: 16845.0
Step [468/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [469/500] | Avg Reward: 0.8575 | Selected Avg: 16849.3
Step [470/500] | Avg Reward: 0.8574 | Selected Avg: 16847.3
Step [471/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [472/500] | Avg Reward: 0.8574 | Selected Avg: 16846.7
Step [473/500] | Avg Reward: 0.8575 | Selected Avg: 16845.7
Step [474/500] | Avg Reward: 0.8575 | Selected Avg: 16847.3
Step [475/500] | Avg Reward: 0.8574 | Selected Avg: 16847.7
Step [476/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [477/500] | Avg Reward: 0.8574 | Selected Avg: 16848.3
Step [478/500] | Avg Reward: 0.8577 | Selected Avg: 16848.7
Step [479/500] | Avg Reward: 0.8571 | Selected Avg: 16846.7
Step [480/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [481/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [482/500] | Avg Reward: 0.8571 | Selected Avg: 16845.7
Step [483/500] | Avg Reward: 0.8574 | Selected Avg: 16846.7
Step [484/500] | Avg Reward: 0.8575 | Selected Avg: 16848.0
Step [485/500] | Avg Reward: 0.8575 | Selected Avg: 16848.7
Step [486/500] | Avg Reward: 0.8573 | Selected Avg: 16847.0
Step [487/500] | Avg Reward: 0.8576 | Selected Avg: 16847.3
Step [488/500] | Avg Reward: 0.8574 | Selected Avg: 16845.3
Step [489/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [490/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [491/500] | Avg Reward: 0.8574 | Selected Avg: 16848.0
Step [492/500] | Avg Reward: 0.8575 | Selected Avg: 16848.3
Step [493/500] | Avg Reward: 0.8575 | Selected Avg: 16846.7
Step [494/500] | Avg Reward: 0.8574 | Selected Avg: 16845.3
Step [495/500] | Avg Reward: 0.8575 | Selected Avg: 16847.7
Step [496/500] | Avg Reward: 0.8573 | Selected Avg: 16844.3
Step [497/500] | Avg Reward: 0.8575 | Selected Avg: 16846.3
Step [498/500] | Avg Reward: 0.8575 | Selected Avg: 16845.0
Step [499/500] | Avg Reward: 0.8576 | Selected Avg: 16847.3
Step [500/500] | Avg Reward: 0.8574 | Selected Avg: 16849.0

>>> Phase 2: 使用训练好的 Agent 全局筛选数据 (Train + Val)...
  原始总数: 19260
  筛选后总数: 19260 (Train选出 16852 + Val选出 2408)

>>> Phase 3: 训练最终分类器并测试...
Training ordinal model on full dataset...
  - Computing kernel matrix for full dataset...
  - Ordinal model trained successfully
Training OPW model on classes 1 and 2 (18705 samples)...
  - Extracting kernel submatrix for classes 1 and 2...
  - OPW model trained successfully
Stage 1: Ordinal prediction...
  - Accepted 159 samples as class 3
Stage 2: OPW prediction for 4656 remaining samples...
========================================
Final Test Result:
Macro F1 Score : 0.8560
G-Mean Score   : 0.8663
========================================

进程已结束，退出代码为 0
